@{
    Layout = "~/Views/Shared/_LayoutHome.cshtml";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <script src="~/Content/QuanLy/Jquery.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.0.min.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {

            //                               $("form").submit(function(evt){
            //evt.preventDefault();
            //var formData = new FormData($(this)[0]);

           
            $("#gui").click(function () {
                var person = {
<<<<<<< HEAD
                    TenDoan: $('#tendoan').val(),
                    HovaTenTruongDoan: $('#Tentruongdoan').val(),
                    Dattungay: $('#datphongtungay').val(),
                    DenNgay: $('#denngay').val(),
=======
                    TenDoan: $ ('#tendoan').val(),
                    TenTruongDoan: $('#Tentruongdoan').val(),
                    ThoiGianNhan: $('#datphongtungay').val(),
                    ThoiGianTra: $('#denngay').val(),
>>>>>>> 2e5c7004caf409f0abda0dcd4e7311817a11bbce
                    Files: $('#xlx_json').val(),

                }

                $.ajax({
                    url: '/api/Home/LayFileDanhSachKhachHang',
                    method: 'POST',
                    dataType: 'json',
                    contentType: 'application/json',
                    //data: JSON.stringify(person),
                    data: JSON.stringify(person),

                    success: function (data) {
                        console.log('Send success')
                        alert(data);

                        //    console.log(res);
                        //},

                        //error: function (xhr, textStatus, errorThrown)
                        //    console.log("eror
                    }

                });

            });
            document.getElementById('file-upload').addEventListener('change', handleFileSelect, false);
        });
        
    </script>


    @*<script type="text/javascript">
            $(document).ready(function () {
                $('#gui').click(function () {
                    $.ajax({
                        url: '/api/Home/TestDuLieuTruyenXuong',
                        method: 'post',
                        data: {
                            TenDoan: $('#tendoan').val(),
                            HovaTenTruongDoan: $('#Tentruongdoan').val(),
                            Dattungay: $('#datphongtungay').val(),
                            DenNgay: $('#denngay').val(),
                            Fileds: $('#xlx_json').val(),
                        },
                        success: function (res) {

                            alert(res);
                        }
                    })
                });

            });







        </script>*@







    
    @*<input type="file" id="file-upload" required>*@

</head>
<body>
    

    <link href="~/Content/Home/css/fileupload.css" rel="stylesheet">
    <script src="~/Content/Home/js/fileupload.js"></script>
    
    <div class="site-wrap">

        <div class="site-mobile-menu">
            <div class="site-mobile-menu-header">
                <div class="site-mobile-menu-close mt-3">
                    <span class="icon-close2 js-menu-toggle"></span>
                </div>
            </div>
            <div class="site-mobile-menu-body"></div>
        </div> <!-- .site-mobile-menu -->





        <div class="site-blocks-cover overlay" style="background-image: url('https://pix6.agoda.net/hotelImages/520/52033/52033_17090518240056008229.jpg?s=1024x768'); " data-aos="fade" data-stellar-background-ratio="0.5">
            <div class="container">
                <div class="row align-items-center justify-content-center">
                    <div class="col-md-7 text-center" data-aos="fade">
                        @*<span class="caption mb-3">Chat With Us</span>*@
                        <h1 class="mb-2">Gửi File Danh Sách </h1>
                    </div>
                </div>
            </div>
        </div>


        <div class="site-section site-section-sm">
            <div class="container">
                <div class="row">

                    <div class="col-md-12 col-lg-8 mb-5">



                        <form action="#" class="p-10 bg-white" id="formguidsdoan" method="post" enctype="multipart/form-data">
                            <div>
                                <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
                                <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
                                <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
                                <script>

                                    var ExcelToJSON = function () {

                                        this.parseExcel = function (file) {
                                            var reader = new FileReader();

                                            reader.onload = function (e) {
                                                var data = e.target.result;
                                                var workbook = XLSX.read(data, {
                                                    type: 'binary'
                                                });
                                                workbook.SheetNames.forEach(function (sheetName) {
                                                    // Here is your object
                                                    var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
                                                    var json_object = JSON.stringify(XL_row_object);
                                                    console.log(JSON.parse(json_object));
                                                    jQuery('#xlx_json').val(json_object);
                                                })
                                            };

                                            reader.onerror = function (ex) {
                                                console.log(ex);
                                            };

                                            reader.readAsBinaryString(file);
                                        };
                                    };

                                    function handleFileSelect(evt) {

                                        var files = evt.target.files; // FileList object
                                        var xl2json = new ExcelToJSON();
                                        xl2json.parseExcel(files[0]);
                                    }



                                </script>
                                <div @*class="wrapper"*@>
                                    <div class="container">
                                        <div class="a">
                                            <h1>Tải Lên File Danh Sách Đoàn</h1>


                                            @*<div class="upload-container">
                            <div class="border-container">
                                <div class="icons fa-4x">
                                    <i class="fas fa-file-image" data-fa-transform="shrink-3 down-2 left-6 rotate--45"></i>
                                    <i class="fas fa-file-alt" data-fa-transform="shrink-2 up-4"></i>
                                    <i class="fas fa-file-pdf" data-fa-transform="shrink-3 down-2 right-6 rotate-45"></i>
                                </div>
                                <div class="a">
                                    <input type="file" id="file-upload" required>
                                </div>
                                <p>
                                    Bấm
                                    <a id="file-browser">Choose File</a> để chọn file ds đoàn cần gửi lên
                                </p>
                            </div>
                        </div>*@

                                        </div>
                                    </div>

                                </div>









                            </div>



                            <div class="row form-group">
                                <div class="col-md-12 mb-3 mb-md-0">
                                    <label class="font-weight-bold" for="fullname">Tên Đoàn</label>
                                    <input type="text" id="tendoan" class="form-control" required @*placeholder="Ví dụ: Đoàn TP HCM"*@>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-md-12 mb-3 mb-md-0">
                                    <label class="font-weight-bold" for="fullname">Họ Và Tên Trưởng Đoàn</label>
                                    <input type="text" id="Tentruongdoan" class="form-control" pattern="{6}" required  @*placeholder="Ví dụ: Đoàn TP HCM"*@>
                                </div>
                            </div>


                            <div class="row form-group">
                                <div class="col-md-12 mb-3 mb-md-0">
                                    <label class="font-weight-bold" for="phone">Đặt Phòng Từ Ngày</label>

                                    <input type="date" id="datphongtungay"  class="form-control" required placeholder="Phone #">
                                </div>
                            </div>

                            <div class="row form-group">
                                <div class="col-md-12 mb-3 mb-md-0">
                                    <label class="font-weight-bold" for="phone">Đến Ngày</label>
                                    <input type="date" id="denngay"  class="form-control" required placeholder="Phone #">

                                </div>


                            </div>
                            <br>
                            <div class="row form-group">
                                <div class="col-md-12 mb-3 mb-md-0">
                                    <input type="file" id="file-upload" name="upload" required>

                                </div>


                            </div>
                            @*<script src="jquery-1.7.1.js" type="text/javascript"></script>*@

                            <div class="a">
                                <br>
                                <br>

                                <input type="button" value="Gửi" id="gui" class="btn btn-primary pill px-4 py-2">

                            </div>

                            <style>
                                div.a {
                                    text-align: center;
                                }
                            </style>
                            <textarea class="form-control" rows=35 cols=120 id="xlx_json" style="display:none"></textarea>


                        </form>




                        @*<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
                            <script>
                                $(document).ready(function () {
                                    // click on button submit
                                    $("#gui").on('click', function () {
                                        // send ajax
                                        $.ajax({
                                            url: 'test.php', // url where to submit the request
                                            type: "POST", // type of action POST || GET
                                            dataType: 'json', // data type
                                            data: $("#formguidsdoan").serialize(), // post data || get data
                                            success: function (result) {
                                                // you can see the result from the console
                                                // tab of the developer tools
                                                console.log(result);
                                            },
                                            error: function (xhr, resp, text) {
                                                console.log(xhr, resp, text);
                                            }
                                        })
                                    });
                                });

                            </script>*@





                    </div>

                    <div class="col-lg-4">
                        <div class="p-4 mb-3 bg-white">
                            <h3 class="h5 text-black mb-3">Thông Tin Liên Hệ</h3>
                            <p class="mb-0 font-weight-bold">Địa Chỉ</p>
                            <p class="mb-4">12 Nguyễn Du, P. Cẩm Phô, Hội An, Quảng Nam, Việt Nam </p>

                            <p class="mb-0 font-weight-bold">Số Điện Thoại</p>
                            <p class="mb-4"><a href="#">+84 123456677</a></p>

                            <p class="mb-0 font-weight-bold">Địa Chỉ Email</p>
                            <p class="mb-0"><a href="#">ColorHotel@gmail.com</a></p>
                            <br />
                            <p class="mb-0 font-weight-bold">Mẫu File Danh Sách</p>
                            <a href="~/Content/Home/FileDSKH/TemplateDSKH.xlsx" download="Mẫu File DS ">
                                <img src="~/Content/Home/FileDSKH/download.png" alt="Mẫu File DS" width="154" height="112">
                            </a>
                        </div>


                    </div>
                </div>
            </div>
        </div>

    </div>

</body>
</html>
